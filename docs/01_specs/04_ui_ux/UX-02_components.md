# UX-02 コンポーネント定義書（EXER 第一版）

## 1. ドキュメント情報

| 項目 | 内容 |
|------|------|
| **ID** | UX-02 |
| **プロジェクト名** | EXER |
| **関連ドキュメント** | REQ-01, REQ-02, UX-01, ARC-02, UX-03, UX-04（デザイン仕様） |

本ドキュメントは枠組みの共通コンポーネント ID（CP-000～CP-018）、テーマ・トークン（推奨）、アクセシビリティ（NFR-F004 の具体）、エラー表示・文言方針（FR-P011）を定義する。プラグイン別のコンポーネント詳細は [04_ui_ux/plugins/UX-03_plugin_python_analysis.md](plugins/UX-03_plugin_python_analysis.md) を参照する。**色・余白・角丸・アイコン等の詳細は [UX-04_design_tokens.md](UX-04_design_tokens.md) を参照する。**

---

## 2. 枠組みの共通コンポーネント

各コンポーネントに **CP-000 ～ CP-018** を付与する。役割と UX-01 の画面（SC-xxx）との対応を記載する。

| コンポーネント ID | 名称 | 役割 | 主な利用画面 |
|-------------------|------|------|--------------|
| **CP-000** | ファーストビュー | ホームの訴求エリア。画像を使わず CSS・JavaScript のみで訴求力のある表現（FR-F023）。 | SC-000 |
| **CP-001** | レイアウト（共通） | ヘッダ・パンくず・メインコンテンツ領域を配置する共通レイアウト。 | 全画面 |
| **CP-002** | パンくず | URL パスから階層構造を表示。動的ルーティングと連動（FR-F001）。ワークブック表示名は仕様で定める（例: py-value → 「Pythonデータ分析」）。 | SC-000, SC-001, SC-002 等 |
| **CP-003** | 問題カード | 問題一覧の 1 件表示。タイトル・難易度・バッジ・タグ・お気に入りボタン・お気に入り数・リンク（FR-F025, FR-F027）。 | SC-001, SC-011 |
| **CP-004** | 問題一覧コンテナ | ソート切り替え UI（登録順・難易度・タイトル・お気に入り数）とタグフィルター、問題カードリスト。0 件時メッセージ表示（FR-F026, FR-F028）。 | SC-001 |
| **CP-015** | 問題集選択 | ワークブック一覧から問題集を選択する UI。選択後は当該ワークブックの問題一覧へ遷移（FR-F024）。 | SC-000 |
| **CP-016** | タグ表示・フィルター | 問題一覧でのタグ表示と、タグによるフィルター UI（FR-F025, FR-F026）。 | SC-001 |
| **CP-017** | お気に入りボタン | 問題カード・ワークスペース等でお気に入り ON/OFF。押下で追加・解除（FR-F027）。 | SC-001, SC-002, SC-011 |
| **CP-018** | お気に入り一覧コンテナ | お気に入り画面のリスト表示。各問題への挑戦・お気に入り解除（FR-F027）。 | SC-011 |
| **CP-005** | 履歴リスト | 解答履歴の一覧表示。問題単位・日時・正誤。 | SC-005 |
| **CP-006** | 履歴詳細ブロック | 単一履歴の詳細表示。userAnswer 要約・正誤・日時。 | SC-006 |
| **CP-007** | 下書き保存ボタン | 明示クリックで下書きを保存するボタン（FR-F005）。 | SC-002 |
| **CP-008** | 解答送信ボタン | 解答を送信し採点を依頼するボタン（FR-F005, FR-F006）。 | SC-002 |
| **CP-009** | 採点結果表示ブロック | 正誤・メッセージ・詳細の表示。SC-003 の構成要素。 | SC-002, SC-003 |
| **CP-010** | 完了画面ブロック | 全問正解時のメッセージと一覧へ戻る導線。 | SC-004 |
| **CP-011** | 管理ダッシュボードレイアウト | 管理画面用のレイアウト・ナビゲーション。 | SC-007 |
| **CP-012** | 問題登録エディタフォーム | 問題の共通項目・type 別拡張の入力フォーム。ステータス切り替え。 | SC-008 |
| **CP-013** | インポート/エクスポート UI | ファイル選択・エクスポート実行・結果表示。 | SC-009 |
| **CP-014** | データセットアップロード UI | ファイルアップロードと結果表示。 | SC-010 |

---

## 3. テーマ・トークン（推奨）

REQ-02 §7 に記載のテーマを**推奨**として定義する。**後で変更可能**とする。実装時はデザイントークンまたは CSS 変数で管理することを推奨する。

| 用途 | 推奨値 | 備考 |
|------|--------|------|
| 背景（ダーク） | `#0d1117` | メイン背景の例。 |
| アクセント（エメラルド） | 例: `#10b981` 系 | ボタン・リンク・成功状態。 |
| アクセント（テックブルー） | 例: `#3b82f6` 系 | 情報・フォーカス。 |
| テキスト（前景） | 十分なコントラストを確保 | WCAG 2.1 のコントラスト比を満たすこと。 |

上記はあくまで推奨であり、プロジェクト方針に応じて変更してよい。**トークン名・スペーシング・角丸・アイコン一覧の詳細は [UX-04 デザイン仕様](UX-04_design_tokens.md) を参照する。**

---

## 4. アクセシビリティ（NFR-F004 の具体）

HIG・Material Design・**WCAG** に沿った要件を定義する。**矛盾時は WCAG を優先**する。

- **キーボード操作**: 主要な操作（問題集選択、問題選択、下書き保存、解答送信、ソート切り替え、タグフィルター、お気に入り、管理画面の CRUD）はキーボードのみで実行可能とする。フォーカス順序は論理的であること。
- **フォーカス**: フォーカスが視覚的に判別可能であること。フォーカストラップはモーダル時のみとし、解除手段を提供する。
- **ラベル**: フォームコントロールには対応するラベルを付与する。アイコンのみのボタンには `aria-label` または代替テキストを提供する。
- **コントラスト**: テキストと背景のコントラスト比は WCAG 2.1 レベル AA を満たす（通常テキスト 4.5:1 以上、大きいテキスト 3:1 以上）。推奨テーマ（§3）を使用する場合もコントラストを確認すること。
- **エラーの伝え方**: バリデーションエラーや API エラーは、該当するフィールドまたは操作と関連付けて伝える。`aria-describedby` や `role="alert"` 等を適宜使用する。
- **その他**: 画像には代替テキストを付与する。動的コンテンツの変更はスクリーンリーダーに通知可能とすることが望ましい（`aria-live` 等）。

---

## 5. エラー表示・文言方針（FR-P011）

プラグインの判定結果や実行結果のエラー種別ごとに、表示方針と推奨文言を定義する。**文言は実装で調整可能**とする。

| 種別 | 表示方針 | 推奨文言（例） |
|------|----------|----------------|
| **タイムアウト** | 実行が制限時間を超えたことを伝える。 | 「実行がタイムアウトしました（制限時間 60 秒）。」 |
| **実行エラー** | コード実行中の例外・エラーメッセージを表示する。 | 「実行エラー: [Python のエラーメッセージ]」 |
| **採点エラー** | 採点処理の失敗（期待値との不一致等）を伝える。 | 「採点できませんでした。期待される形式で出力されているか確認してください。」 |
| **ロードエラー** | Pyodide 等のロード失敗（NFR-P001）。 | 「実行環境の読み込みに失敗しました。ページを再読み込みしてください。」 |

上記は 04_ui_ux での定義であり、実装または 04_ui_ux の改訂で文言を変更してよい。

---

## 6. トレーサビリティ（本ドキュメントで定義するコンポーネント ID と他ドキュメントの対応）

| コンポーネント ID | 対応する REQ-01 | 対応する UX-01 |
|-------------------|-----------------|----------------|
| CP-000 | FR-F023 | SC-000 |
| CP-015 | FR-F024 | SC-000 |
| CP-016 | FR-F025, FR-F026 | SC-001 |
| CP-017 | FR-F027 | SC-001, SC-002, SC-011 |
| CP-018 | FR-F027 | SC-011 |
| CP-003, CP-004 | FR-F003, FR-F025, FR-F026, FR-F028 | SC-001 |
| その他 CP-001～CP-014 | FR-F001～FR-F015 等 | 対応画面を §2 参照 |

---

## 7. 参照

- REQ-01 FR-F002, FR-F009, FR-F018, FR-F023～FR-F028, NFR-F004
- REQ-02 FR-P011（エラー種別）
- UX-01 画面定義（SC-000～SC-011）
- UX-03 データ分析プラグインのコンポーネント（04_ui_ux/plugins/）
