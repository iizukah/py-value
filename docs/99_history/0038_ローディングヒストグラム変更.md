# 0038 ローディングヒストグラム変更（横棒・文言削除、13本、底アニメ抑制）

## 日付

2025-02-08

## 概要

ローディングオーバーレイを「ヒストグラムのみ」に統一し、横棒（scanning-line）と文言（準備中/採点中/実行中）を削除。ヒストグラムを 7 本から 13 本に増やし、サイズ拡大・アニメーションをゆっくりにした。また「ヒストグラムらしさ」のため、底に近いバーは伸びを抑え、頂上付近のみ強くアニメーションするようにした。

## 変更内容

1. **横棒・文言の削除**
   - 全 3 箇所（Pyodide 準備中、採点中/実行中、共通 LoadingOverlay）から scanning-line（横棒）とテキスト（準備中…/採点中…/実行中…）を削除。
   - `globals.css` から未使用の `@keyframes scan` と `.scanning-line-bar` を削除。

2. **ヒストグラムの拡大・13 本化**
   - バー本数: 7 本 → 13 本。高さは山形（正規分布風）: `[0.2, 0.35, 0.5, 0.65, 0.8, 0.9, 1, 0.9, 0.8, 0.65, 0.5, 0.35, 0.2]`。
   - サイズ: 60×120px → 100×202px。バー幅 10px、間隔 6px。

3. **アニメーションの調整**
   - 速度: 1 周期 0.9s → 1.6s、各バー delay 0.08s → 0.12s（ゆっくりめに変更）。
   - 底のバーは伸ばさない: `@keyframes stats-grow` の伸び率を固定値から `var(--stats-grow-max)` に変更。各バーに `--stats-grow-max: 1 + h * 0.5` を指定し、高さ h が小さい（底）ほど scaleY の最大が小さく（例: 1.1）、中央（h=1）のみ 1.5 になるようにした。

4. **デバッグ計装の削除**
   - LoadingOverlay.tsx および index.tsx の 3 箇所にあった `// #region agent log` 〜 `// #endregion` の fetch 計装を削除。

## 変更ファイル

- `src/app/globals.css` — stats-grow で `--stats-grow-max` を利用、scan / scanning-line-bar 削除
- `src/app/components/layout/LoadingOverlay.tsx` — 横棒・文言削除、13 本・拡大・底アニメ抑制、計装削除
- `src/core/plugins/python-analysis/index.tsx` — Pyodide/採点・実行中オーバーレイの同様変更、計装削除

## 関連ドキュメントID

- CD-027（loading overlay, stats-loader）
- DD-023（Pyodide 準備中ローディング）
