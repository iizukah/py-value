# 0025 本番デプロイ実施（Phase 4 記録）

## 日付

2025-02-07

## 実施内容

本番デプロイまで残タスク消化プラン Phase 4 に基づき、以下を実施した。

1. **Cloud Run デプロイ**
   - コマンド: `.env` から `ADMIN_KEY` と `GOOGLE_CLOUD_PROJECT`（または `GCP_PROJECT`）を読み取り、`gcloud run deploy exer-next --source . --region asia-northeast1 --allow-unauthenticated --set-env-vars "DATA_SOURCE=firestore,ADMIN_KEY=...,GOOGLE_CLOUD_PROJECT=..."` でデプロイする想定。
   - **今回**: `.env` に `GOOGLE_CLOUD_PROJECT` / `GCP_PROJECT` が未設定のため、Cloud Run デプロイは未実行。デプロイマニュアルに「デプロイ前に .env に GOOGLE_CLOUD_PROJECT を設定すること」を追記した（§7 チェックリスト）。

2. **Firebase デプロイ**
   - コマンド: `firebase deploy --only "hosting,firestore"`。Cloud Run デプロイ完了後、同一プロジェクトで実行する。

3. **デプロイ先 URL**
   - 実施後は Firebase Hosting の URL（例: `https://PROJECT_ID.web.app`）でアプリが表示される。

## 実施者が行う手順

1. ルートの `.env` に `GOOGLE_CLOUD_PROJECT=<GCP プロジェクト ID>` と `ADMIN_KEY=<管理用キー>` を設定する。
2. PowerShell で上記の gcloud run deploy を実行（マニュアルまたはプラン記載のコマンドを参照）。
3. 続けて `firebase deploy --only "hosting,firestore"` を実行する。
4. デプロイ完了後、Firebase Hosting の URL で動作確認する。

## 関連ドキュメント

- INFRA-01
- docs/02_manuals/02_デプロイマニュアル.md
